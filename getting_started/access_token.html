
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Access Token &#8212; MatrixCtl 0.10.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SSH Public Key" href="ssh_pubkey.html" />
    <link rel="prev" title="Synapse Playbook" href="synapse_playbook.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ssh_pubkey.html" title="SSH Public Key"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="synapse_playbook.html" title="Synapse Playbook"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">MatrixCtl 0.10.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Getting Started</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Access Token</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="access-token">
<h1>Access Token<a class="headerlink" href="#access-token" title="Permalink to this headline">¶</a></h1>
<p>To use the API of Synapse you need a access token of an administrator.
To get an access token, you need an user account.
MatrixCtl helps you to register one. Just run:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>matrixctl adduser --ansible --admin myusername
<span class="go">Password:</span>
<span class="go">Password (again):</span>
<span class="go">Username: myusername</span>
<span class="go">Password: **HIDDEN**</span>
<span class="go">Admin:    yes</span>
<span class="go">Is everything ok? [y/n]y</span>

<span class="go">PLAY [Set up a Matrix server] *********************************************************************************</span>

<span class="go">[...]</span>

<span class="go">PLAY RECAP ****************************************************************************************************</span>
<span class="go">matrix.michaelsasser.org   : ok=24   changed=0    unreachable=0    failed=0    skipped=34   rescued=0    ignored=0</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don’t enter a password and press [ENTER] twice, a password
will be generated for you. If you are satisfied with it, enter [y].</p>
</div>
<p>Now you have created your user with the user name “myusername”. The argument
<code class="docutils literal notranslate"><span class="pre">--admin</span></code> makes sure, that you create an administrator account instead of an
user account. The <code class="docutils literal notranslate"><span class="pre">--ansible</span></code> argument is needed, because you currently have
no access to the admin API. After all that steps you don’t need the
<code class="docutils literal notranslate"><span class="pre">--ansible</span></code> anymore.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can use this user account as your personal main user account.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have alredy created an admin user account ignore this step
and continue below.</p>
</div>
<p>Now Open <code class="docutils literal notranslate"><span class="pre">https://element.yourdomain.tld</span></code> to login.</p>
<figure class="align-center" id="id1">
<img alt="login screen image" src="../_images/loginscreen.png" />
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">The Element loginscreen</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Click on “Sign In” and enter your credentials. In this example, we used
“myusername” for the user and the entered password to login.</p>
<figure class="align-center" id="id2">
<img alt="login screen login image" src="../_images/loginscreen_login.png" />
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Entering credentials</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>After you are logged in, click on your user name in the top right corner. A
small window will pop up. Click on <code class="docutils literal notranslate"><span class="pre">Settings</span></code>.</p>
<figure class="align-center" id="id3">
<img alt="click on settings image" src="../_images/click_on_settings.png" />
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Click on “Settings”</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>A bigger window with your user settings will pop up. Click on <code class="docutils literal notranslate"><span class="pre">Help</span> <span class="pre">&amp;</span> <span class="pre">About</span></code>
on the left side of that window. If you scroll down on the right
hand side of this window, you will find the <code class="docutils literal notranslate"><span class="pre">Advanced</span></code> section.
In the Advanced section you find <code class="docutils literal notranslate"><span class="pre">Access</span> <span class="pre">Token:</span> <span class="pre">&lt;click</span> <span class="pre">to</span> <span class="pre">reveal&gt;</span></code>.</p>
<figure class="align-center" id="id4">
<img alt="click on reveal access token image" src="../_images/reveal_access_token.png" />
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Click on “&lt;click to reveal&gt;”</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Now click on <code class="docutils literal notranslate"><span class="pre">&lt;click</span> <span class="pre">to</span> <span class="pre">reveal&gt;</span></code>.</p>
<figure class="align-center" id="id5">
<img alt="the revealed access token image" src="../_images/revealed_access_token.png" />
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">The revealed access token</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>This is your access token. It is already highlighted for you. Just copy it into
the config file into the <code class="docutils literal notranslate"><span class="pre">[API]</span></code> section.</p>
<section id="copy-the-token">
<h2>Copy The Token<a class="headerlink" href="#copy-the-token" title="Permalink to this headline">¶</a></h2>
<p>Now you can copy the token into the <code class="docutils literal notranslate"><span class="pre">[API]</span></code> section of your config file.
If you don’t have a config file head over to the <a class="reference internal" href="config_file.html#config-file"><span class="std std-ref">Config File</span></a> chapter.</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">...</span>
<span class="k">[API]</span>
<span class="n">Domain</span><span class="o">=</span><span class="n">yourdomain</span><span class="p">.</span><span class="n">tld</span>
<span class="n">Token</span><span class="o">=</span><span class="s">&quot;MDAxZmxvY2F0aW9uIG1pY2hhZWxzYXNzZXIub3JnCjAwMTNpZGVudGlmaWVyIGtleQowMDEwY2lkIGdlbiA9IDEKMDAzMGNpZCB1c2VyX2lkID0gQG15dXNlcm5hbWU6bWljaGFlbHNhc3Nlci5vcmcKMDAxNmNpZCB0eXBlID0gYWNjZXNzCjAwMjFjaWQgbm9uY2UgPSA3WkB1KkdyY3JTRG1CI3Z0CjAwMmZzaWduYXR1cmUgJblnYOAEQJVeHaMgwnMsAagpZBc8CIC6Dwwy027tfJAK&quot;</span>
<span class="p">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To be able to use the admin API, you need to have
<code class="docutils literal notranslate"><span class="pre">matrix_nginx_proxy_proxy_matrix_client_redirect_root_uri_to_domain:</span> <span class="pre">&quot;&quot;</span></code>
and
<code class="docutils literal notranslate"><span class="pre">matrix_nginx_proxy_proxy_matrix_client_api_forwarded_location_synapse_admin_api_enabled:</span> <span class="pre">true</span></code>
in your <code class="docutils literal notranslate"><span class="pre">vars.yml</span> <span class="pre">file.</span> <span class="pre">This</span> <span class="pre">will</span> <span class="pre">stop</span> <span class="pre">the</span> <span class="pre">playbook</span> <span class="pre">from</span> <span class="pre">setting</span>
<span class="pre">up</span> <span class="pre">a</span> <span class="pre">redirect</span> <span class="pre">``matrix.yourdomain.tld</span></code> to
<code class="docutils literal notranslate"><span class="pre">element.yourdomain.tld</span></code></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Never ever, ever give this token to anyone else. If you have other
administrators on that server, they should use their own token.
With this token you can login and do anything on that matrix
instance in <strong>your name</strong>.</p>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Access Token</a><ul>
<li><a class="reference internal" href="#copy-the-token">Copy The Token</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="synapse_playbook.html"
                        title="previous chapter">Synapse Playbook</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ssh_pubkey.html"
                        title="next chapter">SSH Public Key</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/getting_started/access_token.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ssh_pubkey.html" title="SSH Public Key"
             >next</a> |</li>
        <li class="right" >
          <a href="synapse_playbook.html" title="Synapse Playbook"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">MatrixCtl 0.10.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Getting Started</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Access Token</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Michael Sasser.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.2.
    </div>
  </body>
</html>